.row
= simple_form_for @booking do |f|
  - host = @booking.bookee
  .col-xs-12
    %table.table.table-striped.table-condensed
      %tr
        %td
          %strong Host
        %td= host.name
      - if host.received_feedbacks.present?
        - rating_stars host.average_rating
        %tr
          %td
            %strong Feedback
          %td= "#{host.average_rating} #{'star'.pluralize(host.average_rating)}"
      %tr
        %td
          %strong Description
        %td= host.homestay.description
      - if !@booking.host_accepted # Dates can be edited
        %tr
          %td
            %strong Check in date
          %td
            = f.input :check_in_date, label: false, as: :date_picker, wrapper_html: { class: "input-append enabled_datepicker" }, readonly: true, input_html: { value: @booking.check_in_date.strftime('%d/%m/%Y'), class: 'span2 checkin', :id => "datepicker-check-in-date" }

            -# f.input :check_in_time, label: false, as: :time_picker, wrapper_html: { class: "input-append timepicker" }, readonly: true, input_html: { value: @booking.check_in_time.strftime("%H:%M") }
        %tr
          %td
            %strong Check out date
          %td
            = f.input :check_out_date, label: false, as: :date_picker, wrapper_html: { class: "input-append enabled_datepicker" }, readonly: true, input_html: { value: @booking.check_out_date.strftime('%d/%m/%Y'), class: 'span2 checkout', id: "datepicker-check-out-date" }

            -# f.input :check_out_time, label: false, as: :time_picker, wrapper_html: { class: "input-append timepicker" }, readonly: true, input_html: { value: @booking.check_out_time.strftime("%H:%M") }
      - else
        - unless @booking.check_in_date.blank?
          %tr
            %td 
              %strong Check In
            %td= @booking.check_in_date.strftime("%A, %d/%m/%Y")
        - unless @booking.check_out_date.blank?
          %tr
            %td 
              %strong Check Out
            %td= @booking.check_out_date.strftime("%A, %d/%m/%Y")
      %tr
        %td
          %strong Number of nights
        %td= @booking.number_of_nights
  .row
    .col-xs-12
      %h3.text-center Booking Details
      %table.table.table-striped
        %tr
          %td Daily Rate
          %td= number_to_currency(@booking.cost_per_night)
        %tr
          %td Total Rate
          %td= number_to_currency(@booking.subtotal)
        %tr
          %td Credit Card Fee
          %td= number_to_currency(@booking.transaction_fee)
        - if @coupon
          %tr
            %td Discount (code: #{@coupon.code})
            %td= number_to_currency(@coupon.discount_amount)
          %tr
            %td Total
            %td= number_to_currency(@booking.amount - @coupon.discount_amount)
        - else
          %tr
            %td Total
            %td= number_to_currency(@booking.amount)
    %hr
  .row
    .col-xs-12
      - if @booking.payment.present?
        %h3.text-center= "Payment successfully made on #{@booking.payment.created_at.in_time_zone('Melbourne').strftime("%A, %d/%m/%Y at %l:%M %p %Z")}"
      - else
        %p You can make the payment securely either through Paypal or via Credit Card below. All transactions are encrypted.
        %form#checkout{:url => booking_path(@booking), :method => "put"}
          #dropin
          - if @coupon
            %input{:type => "submit", :value => "Pay #{number_to_currency(@booking.amount - @coupon.discount_amount)}", :class => "btn btn-primary btn-large"}
          - else
            %input{:type => "submit", :value => "Pay #{number_to_currency(@booking.amount)}", :class => "btn btn-primary btn-large"}
        %script{:type => "text/javascript", :src  => "https://js.braintreegateway.com/v2/braintree.js"}
        :javascript
          braintree.setup("#{@client_token}", 'dropin', {
          container: 'dropin'
          });