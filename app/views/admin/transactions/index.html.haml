= link_to 'Admin Dashboard', admin_dashboard_path, class: 'btn pull-right'
%h1 Listing Transactions
%table.table.tablesorter
  %thead
    %tr
      %th Guest
      %th Host
      %th Reference Id
      %th Date
      %th Pre-auth Id
      %th Response Text
      %th Amount
      %th Status

  %tbody
    - @transactions.each do |transaction|
      - booking = transaction.booking
      - booking_status = Booking.human_state_name(booking.state.to_sym)
      %tr{ class: booking_status == 'host has been paid' ? 'completed' : '' }
        - guest = booking.booker
        - host = booking.bookee
        %td= link_to (guest.name || 'n/a'), admin_user_path(guest)
        %td= link_to (host.name || 'n/a'), admin_user_path(host)
        %td= link_to transaction.reference, admin_view_booking_url(booking)
        %td= transaction.updated_at.strftime('%d/%m/%Y')
        %td= transaction.pre_authorisation_id
        %td= transaction.response_text
        %td= currency_formatter(transaction.amount)
        %td
          %strong= booking_status

:javascript
  $(document).ready(function(){
    $('table.tablesorter').tablesorter({headers:{3:{sorter:false}}});
  });


